<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="./css/Tyres.css"/>

</head>

<body>
<header id="header">
    <div class="logo"><a href="index.html">CONTROL- <span>MONTHLY MILEAGE AND KM/LT</span></a></div>

    <a href="#menu">Menu</a>
</header>
<div class="wrapper">
    <div class="container">
        <div class="form">
            <div class="form-block">
                <div class="form-section form-section--horizontal">
                    <div class="input-field input-field--horizontal">

                        <label class="input-field__label input-field__label--start">ALL/COP/COM</label>
                        <select type="text" name="busCategory" id="busCategory"
                                class="input-field__input input-field__input--small">
                            <option SELECTED DISABLED> SELECT CATEGORY</option>
                            <option value="COMMERCIAL">COMMERCIAL</option>
                            <option value="ALLIANCE">ALLIANCE</option>
                            <option value="COPORATE">COPORATE</option>
                        </select>
                        <div class="input-field input-field--horizontal">
                            <label class="input-field__label input-field__label--right">COA/MIN</label>
                            <select type="text" name="busType" id="busType"
                                    class="input-field__input input-field__input--small">
                                <option SELECTED DISABLED> SELECT TYPE</option>
                                <option value="COACHES">COACHES</option>
                                <option value="MINI-BUS">MINI-BUS</option>
                            </select>
                        </div>
                        <div class="input-field input-field--horizontal">
                            <label class="input-field__label input-field__label--right">Bus Reg No</label>

                            <select type="text" name="busdropdown" id="busdropdown"
                                    class="input-field__input input-field__input--small">
                                <script>

                                    function removeOptions(selectbox) {
                                        for (let i = 0; i < selectbox.length; i++) {
                                            selectbox.remove(i);
                                        }
                                    }


                                   // const url = 'http://localhost:3000/buslist';
                                     const url = 'https://eng-api.herokuapp.com/buslist';

                                    let category = '';
                                    let type = '';

                                    var bus_category = document.getElementById('busCategory');
                                    var bus_type = document.getElementById('busType');


                                    bus_category.addEventListener('click', function (e) {
                                        let dropdown = document.getElementById('busdropdown');
                                        removeOptions(dropdown);
                                        dropdown.length = 0;
                                        let defaultOption = document.createElement('option');
                                        defaultOption.text = 'Select Bus';

                                        dropdown.add(defaultOption);
                                        dropdown.selectedIndex = 0;

                                        category = bus_category.value;
                                        type = bus_type.value;
                                        fetch(url)
                                            .then(
                                                function (response) {
                                                    if (response.status !== 200) {
                                                        console.warn('Looks like there was a problem. Status Code: ' +
                                                            response.status);
                                                        return;
                                                    }

                                                    // Examine the text in the response
                                                    response.json().then(function (data) {
                                                        let option;

                                                        for (let i = 0; i < data.length; i++) {
                                                            if (category == data[i].category && type == data[i].type) {
                                                                option = document.createElement('option');
                                                                option.text = data[i].registry_no;
                                                                option.value = data[i].registry_no;
                                                                dropdown.add(option);
                                                            }

                                                        }
                                                    });
                                                }
                                            )
                                            .catch(function (err) {
                                                console.error('Fetch Error -', err);
                                            });
                                    });

                                    bus_type.addEventListener('click', function (e) {
                                        let dropdown = document.getElementById('busdropdown');
                                        removeOptions(dropdown);
                                        dropdown.length = 0;

                                        let defaultOption = document.createElement('option');
                                        defaultOption.text = 'Select Bus';

                                        dropdown.add(defaultOption);
                                        dropdown.selectedIndex = 0;

                                        category = bus_category.value;
                                        type = bus_type.value;
                                        fetch(url)
                                            .then(
                                                function (response) {
                                                    if (response.status !== 200) {
                                                        console.warn('Looks like there was a problem. Status Code: ' +
                                                            response.status);
                                                        return;
                                                    }

                                                    // Examine the text in the response
                                                    response.json().then(function (data) {
                                                        let option;

                                                        for (let i = 0; i < data.length; i++) {
                                                            if (category == data[i].category && type == data[i].type) {
                                                                option = document.createElement('option');
                                                                option.text = data[i].registry_no;
                                                                option.value = data[i].registry_no;
                                                                dropdown.add(option);
                                                            }

                                                        }
                                                    });
                                                }
                                            )
                                            .catch(function (err) {
                                                console.error('Fetch Error -', err);
                                            });
                                    });

                                </script>
                            </select>
                        </div>
                    </div>


                </div>

                <div class="form-section form-section--horizontal">
                    <div class="input-field input-field--horizontal">
                        <div class="input-field input-field--horizontal">
                            <label class="input-field__label input-field__label--start">KM (Current) </label>
                            <input name="extra_contract" id="currentKm" type=""
                                   class="input-field__input input-field__input--tiny-fixed">
                        </div>

                        <div class="input-field input-field--horizontal">
                            <label class="input-field__label input-field__label--right">FUEL (lts) </label>
                            <input name="extra_contract" id="fuelLitres" type=""
                                   class="input-field__input input-field__input--tiny-fixed">
                        </div>

                        <div class="input-field input-field--horizontal">
                            <label class="input-field__label input-field__label--start">E/OIL (lts) </label>
                            <input name="extra_contract" id="oilLitres" type=""
                                   class="input-field__input input-field__input--tiny-fixed">
                        </div>

                        <div class="input-field input-field--horizontal">
                            <label class="input-field__label input-field__label--right">DATE </label>
                            <input name="extra_contract" id="date" type="date"
                                   class="input-field__input input-field__input--small">
                        </div>

                    </div>

                </div>

                <div class="form-section form-section--horizontal">
                    <div class="input-field input-field--horizontal">



                        <div class="input-field input-field--horizontal">
                            <label class="input-field__label input-field__label--right">FUEL (km/lts) </label>
                            <input name="extra_contract" id="fuelLitresKm" type=""
                                   class="input-field__input input-field__input--tiny-fixed">
                        </div>

                        <div class="input-field input-field--horizontal">
                            <label class="input-field__label input-field__label--start">E/OIL (km/lts)</label>
                            <input name="current_milleage" id="oilLitresKm" type=""
                                   class="input-field__input input-field__input--tiny-fixed">
                        </div>

                        <div class="input-field input-field--horizontal">
                            <label class="input-field__label input-field__label--start">Remarks</label>
                            <input name="current_milleage" id="remarks" type="text"
                                   class="input-field__input input-field__input--small">
                        </div>

                        <div class="input-field input-field--horizontal">

                        </div>
                    </div>
                </div>

                <div class="input-field__label--right">
                    <button class="input-field__button" id="addMonthlyButton"> Save</button>
                </div>

                <div class="form-section">
                    <div class="table-field">
                        <table class="table">
                            <thead>
                            <tr>
                                <th class="table__head">Registry No</th>
                                <th class="table__head">Km (Current)</th>
                                <th class="table__head">Fuel (lts)</th>
                                <th class="table__head">Fuel (km/lts)</th>
                                <th class="table__head">E/Oil (lts)</th>
                                <th class="table__head">E/Oil (km/lts)</th>
                            </tr>
                            </thead>
                            <tbody id="monthlyTableBody">
                            <!-- remove the td when working with data. this is for only styling -->
                            <!-- <tr>
                                <td>Emma</td>
                                <td>47</td>
                                <td>1</td>
                                <td>12</td>
                            </tr> -->
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>

</div>
<nav id="menu">
    <ul class="links">

        <li><a href="/Particulars">Particulars of Vehicles</a></li>
        <li><a href="/Tyre">Tyres</a></li>
        <li><a href="/Repairs">Report and maintenance record</a></li>
        <li><a href="/Oil">Date of oil change</a></li>
        <li><a href="/Monthly">Monthly Mileage and km/lt</a></li>
        <li><a href="#">Report</a></li>
        <li><a href="/grid">Home</a></li>
        <li><a href="/logout">Logout</a></li>
    </ul>
</nav>

<!-- Banner -->

<!-- Scripts -->
<script src="./js/jquery.min.js"></script>
<script src="./js/jquery.scrolly.min.js"></script>
<script src="./js/jquery.scrollex.min.js"></script>
<script src="./js/skel.min.js"></script>
<script src="./js/util.js"></script>
<script src="./js/main.js"></script>


<script src="./js/jquery.js"></script>
<script src="./js/control/Monthly.js"></script>
<script src="./js/sweetalert.min.js"></script>
</body>
</html>